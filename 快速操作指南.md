# 🔧 快速操作指南

## ⚡ 第一步：重启服务器和 Worker

### 如果是在开发环境

**终端 1 - 重启服务器：**
```bash
cd apps/server
# 按 Ctrl+C 停止当前服务器
pnpm dev
```

**终端 2 - 重启 Worker：**
```bash
cd apps/server
# 按 Ctrl+C 停止当前 worker
pnpm worker:dev
```

### 如果是在生产环境

```bash
cd apps/server
pnpm build
pm2 restart judada-server
pm2 restart judada-worker
```

---

## 📊 第二步：查看日志

重启后，**保持服务器终端打开**，然后：

1. 打开浏览器，访问你的管理后台
2. 进入有问题的课程包页面（能看到"素材与关卡树"的地方）
3. **切换到服务器终端**，你会看到类似这样的日志：

```
[API] GET /course-packages/xxx/materials - 开始获取素材树
[DEBUG MaterialLessonTree] Lesson #344 "核心词汇训练": {
  lessonId: 'xxx',
  summary: '针对主题核心词汇进行理解与记忆',
  payloadCn: '针对主题核心词汇进行理解与记忆',
  payloadEn: 'Monday What do you have on Fridays?',
  isCnSameAsSummary: '⚠️ 警告：cn 等于 summary!'
}
```

---

## 🔍 第三步：分析日志

### ✅ 如果看到 `isCnSameAsSummary: '✓ 正常'`
说明数据正常，问题可能在其他地方。

### ⚠️ 如果看到 `⚠️ 警告：cn 等于 summary!`
说明该关卡的数据有问题：
- `payloadCn` 存储的是摘要，而不是翻译
- 需要手动编辑修复，或者我可以帮你写批量修复脚本

---

## 📋 第四步：将日志发给我

**请将服务器终端输出的日志（特别是带有 `[DEBUG MaterialLessonTree]` 的那些行）复制发给我**，我会：

1. 分析具体哪些关卡有问题
2. 告诉你需要修复的内容
3. 如果需要，我可以创建批量修复脚本

---

## 💡 注意事项

- ⚠️ **必须重启服务器和 Worker**，新代码才会生效
- 📝 **保持终端打开**，日志会实时显示
- 🔄 访问管理后台页面时，日志才会输出
- 📸 如果可能，截图或复制完整的日志输出

---

## 🎯 预期结果

修复后：
- ✅ 新生成的关卡将显示正确的翻译
- ✅ 日志中会显示详细的数据结构
- ✅ 我们可以根据日志判断哪些历史数据需要修复
